# Чеклисты

## Перед ответом на вопрос

- [ ] Загружен минимум 1 релевантный файл
- [ ] Определён тип репозитория (Pack/Downstream/...)
- [ ] Ответ опирается на контекст репозитория
- [ ] Источники указаны
- [ ] **Pack direct read:** При поиске конкретного знания в Pack — Read наиболее вероятный файл напрямую, не только vector search (индекс может быть stale)

> **Урок (2026-02-17):** knowledge-mcp вернул stale версию DP.CONCEPT.001 (без §7), и я ответил «этого нет в Pack» — хотя оно было. Причина: положился на vector search, не прочитал файл напрямую.

## Перед изменением репозитория

- [ ] Прочитан REPO-TYPE.md (если есть)
- [ ] Прочитан CLAUDE.md репозитория (если есть)
- [ ] Понятна роль этого репо в архитектуре
- [ ] Изменения не нарушают source-of-truth
- [ ] Есть описанный процесс (PROCESSES.md) для изменений этого масштаба

## При записи процесса/решения о системе

- [ ] **Pack** — записано в паспорт системы (DP.AISYS.xxx)
- [ ] **PROCESSES.md** — записано в репо системы
- [ ] **CLAUDE.md** — краткая ссылка (если кросс-системное)

> **Урок (2026-02-16):** Процесс Issue Funnel записан в CLAUDE.md и PROCESSES.md, но забыт Pack. Причина: «процесс ≠ доменное знание» — ложное различение. Процесс обслуживания системы = часть паспорта системы. **Правило: процесс системы ВСЕГДА в Pack + PROCESSES.md.**

## Перед созданием документа

- [ ] **Спросить пользователя** — предложить место с обоснованием
- [ ] Определён тип документа
- [ ] Определено место размещения (подтверждено пользователем)
- [ ] Frontmatter заполнен
- [ ] Связи с другими документами указаны

> **Правило:** Прежде чем записывать в любой репозиторий — спроси пользователя и предложи место с обоснованием: репо + путь + почему + альтернативы.

## Перед предложением фикса / архитектурного решения

> **ПРАВИЛО (2026-02-13):** Никогда не предлагай тактические заплатки без предварительной оценки по 6 характеристикам (ЭМОГСС). Если фикс слаб по ≥2 характеристикам — СТОП, ищи правильное решение.

- [ ] **АрхГейт ДО ответа:** Таблица ЭМОГСС включена В ПЕРВЫЙ ответ с решением, не во второй после запроса
- [ ] **Существующие паттерны:** Проверь «как это уже решено в кодовой базе?» до предложения нового подхода
- [ ] **Корневая причина:** Исправляется причина, а не симптом
- [ ] **BC check:** Ответственность в правильном Bounded Context? (не дублировать логику сервера на клиенте)
- [ ] **Coupling:** Не создаёт ли фикс новую хрупкую связь? (ручные словари, магические константы)
- [ ] **Итеративные заплатки:** Если второй коммит «чинит» первый — остановись и пересмотри подход

> **Урок (2026-02-15):** Предложил `submitted: common.mode_select` (грубый хак) вместо silent return (существующий паттерн). Причина: не применил АрхГейт сразу. Эволюционируемость и Современность поймали бы ошибку с первого раза. **Правило: АрхГейт — в первый ответ, не после запроса критики.**
> **Урок (2026-02-13):** 3 итеративные заплатки в retrieval.py — каждая обходила проблему. Правильное решение = доверять MCP + fuzzy correction.

## Close (дополнение к CLAUDE.md § 2)

> **ПРАВИЛО:** Перед выполнением Close — ПЕРЕЧИТАЙ CLAUDE.md § 2 чеклист Close. Не выполняй по памяти.

- [ ] WP Context File создан/обновлён в `DS-my-strategy/inbox/WP-{N}-{slug}.md`
  - Текущее состояние, решения, следующие шаги
  - **Создавать при ПЕРВОМ Close**, не откладывать
- [ ] Если создано новое репо → MAPSTRATEGIC.md (roadmap фаз)
- [ ] Если создано новое репо → Strategy.md (в источники MAPSTRATEGIC)

> **Урок (2026-02-11):** WP Context File не был создан вовремя, потому что не был в todo и не в Close-протоколе. Теперь обязателен.
> **Урок (2026-02-12):** WP Context File и MAPSTRATEGIC пропущены при Close, потому что протокол выполнялся «по памяти» без перечитывания чеклиста. Правило: всегда перечитывай CLAUDE.md § 2 чеклист.
