# Правила работы по типам репозиториев

> Реестр репо: `DS-ecosystem-development/0.OPS/REPOSITORY-REGISTRY.md`

## 3 типа репозиториев

| Тип | Подтип | Что содержит | Source-of-truth | Кто создаёт |
|-----|--------|-------------|-----------------|-------------|
| **Base** | Принципы | ZP, FPF, SPF | Да | Платформа |
| **Base** | Форматы | FMT-* (протоколы структуры) | Да (для формата) | Платформа |
| **Pack** | — | Доменные знания (вторые принципы) | Да | Пользователь |
| **DS** | instrument / governance / surface | Производные от Pack | Нет | Пользователь |

> Base = платформа выдаёт. Pack и DS = пользователь создаёт.
> Pack = вторые принципы. DS = третьи принципы. Подробно: `ZP/README.md`

## Base (платформа)

### Base/Принципы (ZP, FPF, SPF)

**Содержит:** Нулевые принципы (ZP), фреймворки корректности (FPF, SPF), карта иерархии.

**Можно:** Уточнять формулировки принципов, обновлять карту иерархии, спецификации формы/процесса.

**Нельзя:** Доменное содержание (→ Pack). Дидактику (→ DS/surface).

### Base/Форматы (FMT-*)

**Содержит:** Протоколы структуры репо (FMT-exocortex-template, FMT-s2r).

**Можно:** Уточнять спецификацию формата, добавлять примеры.

**Нельзя:** Предметное содержание (→ Pack). Код (→ DS/instrument).

> Пользователь может создать свой формат — это будет DS с пометкой `template: true` в REPO-TYPE.md.

## Pack (source-of-truth) = вторые принципы

**Содержит:** Формализованные знания домена, методы, work products, failure modes, различения, SoTA-аннотации.

**Можно:** Добавлять/изменять знание домена, методы, WP, FM. Обновлять SoTA.

**Нельзя:** Дидактику (шаги, уроки). Путать метод с инструментом. Копировать без формализации. Хранить общие концепции FPF/SPF. Хранить планы/сроки/роли (→ Governance).

**Lint:** Проверяй process-lint перед коммитом.

> Pack содержит ТОЛЬКО доменное знание. FPF/SPF → Base/Принципы. Планы → DS/governance.

## DS (все подтипы)

> DS НЕ source-of-truth. Знание берётся из Pack.

| Подтип | Можно | Нельзя |
|--------|-------|--------|
| `instrument` | Код, тесты, документация кода | Менять source-of-truth |
| `governance` | Планы, реестры, решения | Менять предметное знание |
| `surface` | Курсы, гайды, маршруты | Создавать знание (только потреблять) |

### Правило минимума в DS/instrument

> **Репо агентов/ботов = преимущественно код и текст-как-код.**
> Архитектурные решения, UX-модели, доменные описания → Pack цифровой платформы.
> Межсистемные сценарии → DS-ecosystem-development.
> В instrument-репо остаётся: код, конфиги, CLAUDE.md (привязка к Pack), README (как запустить).

### Именование DS/instrument для ИИ-систем

Конвенция: `DS-{slug}` (примеры: `DS-strategist-agent`, `DS-extractor-agent`).
Привязка к Pack через `source-of-truth: {ID}` в CLAUDE.md репо, не через имя.

### DS/governance: DS-my-strategy (личная база данных)

**Содержит:** Планы недели, заметки (inbox/), контексты РП, extraction reports, онтологию.

**СТРОГО НЕЛЬЗЯ:** Скрипты, код, промпты, launchd-конфиги, агенты. Это ТОЛЬКО база данных — входы и выходы агентов. Агенты живут в своих DS-*-agent/ репо или DS-synchronizer/.

### DS/governance (DS-ecosystem-development)

**Содержит:** Справочный контент, реестры, планы, процессы, оргструктуру, ADR.

**Правило чистоты:** Pack-контент в DS-ecosystem-development → предложи миграцию в Pack. Architecture-папки = ссылки + реестры, НЕ знания домена.

---

## Repository-first режим

**Никогда не отвечай из общих знаний без опоры на репозиторий.**

1. Найди минимум 1-2 релевантных файла в репозитории
2. Собери Context Pack
3. Только потом формируй ответ

Если контекст не найден → скажи "в репозитории нет источника", предложи создать документ.

---

## Context Pack (формат)

```markdown
## Context Pack для [запрос]
### Источники:
1. `путь/к/файлу.md` — описание
### Ключевые выдержки:
> [цитата с источником]
### Не использовано:
- Документ X — не релевантен, т.к. ...
```

---

## Frontmatter (базовый)

```yaml
---
type: doc    # doc, spec, process, report
status: draft # draft, active, archived
created: YYYY-MM-DD
updated: YYYY-MM-DD
---
```
