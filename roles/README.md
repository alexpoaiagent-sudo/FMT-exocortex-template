# Роли экзокортекса

> Роли описывают **что делается**, а не **кто делает**. Один агент может выполнять несколько ролей. Одну роль могут делить несколько исполнителей.
> Source-of-truth архитектуры ролей: DP.D.033 (Role-Centric Architecture).

---

## Обзор

| Роль | ID | Тип | Сценарии | Автоматизация |
|------|----|-----|----------|---------------|
| [Стратег](strategist/) | R1 | ИИ-агент (Claude) | 9 | launchd (утро, вечер, неделя) |
| [Экстрактор](extractor/) | R2 | ИИ-агент (Claude) | 4 | launchd (каждые 3 часа) |
| [Синхронизатор](synchronizer/) | R8 | Bash-инструмент | 5 скриптов | launchd (10 точек/день) |

## Стратег (R1)

**Назначение:** Планирование, обзор и рефлексия. Создаёт планы дня, итоги недели, готовит материалы для стратегических сессий.

**Сценарии:**

| Сценарий | Когда | Результат |
|----------|-------|-----------|
| day-plan | Каждое утро (Вт-Вс) | `DayPlan YYYY-MM-DD.md` |
| session-prep | Утро (Пн) | `WeekPlan W{N}.md` (черновик) |
| week-review | Ночь (Вс→Пн) | `WeekReport W{N}.md` |
| note-review | Вечер (23:00) | Классификация заметок из inbox |
| strategy-session | По запросу | Интерактивная стратегическая сессия |
| + 4 других | По запросу | См. `strategist/prompts/` |

**Установка:** `bash roles/strategist/install.sh`

---

## Экстрактор знаний (R2)

**Назначение:** Извлечение, классификация и маршрутизация знаний в Pack-репозитории. Human-in-the-loop: всегда предлагает, никогда не пишет без одобрения.

**Сценарии:**

| Сценарий | Когда | Результат |
|----------|-------|-----------|
| session-close | Закрытие сессии | Captures → Pack (с одобрения) |
| on-demand | По запросу | Извлечение конкретного знания |
| inbox-check | Каждые 3 часа | Обработка заметок и captures |
| knowledge-audit | По запросу | Аудит полноты Pack |

**Конфигурация:** `config/routing.md` — таблица маршрутизации (какие Pack-репо есть, куда что класть).

**Установка:** `bash roles/extractor/install.sh`

---

## Синхронизатор (R8)

**Назначение:** Центральный диспетчер расписания, уведомления, мониторинг. Не ИИ-агент — bash-инструмент, оркестрирующий остальные роли.

**Скрипты:**

| Скрипт | Что делает |
|--------|-----------|
| `scheduler.sh` | Диспетчер: определяет какие задачи запустить в текущий час |
| `notify.sh` | Отправка уведомлений в Telegram |
| `code-scan.sh` | Ночной обзор коммитов в downstream-репо |
| `daily-report.sh` | Утренняя сводка результатов ночных задач |
| `sync-files.sh` | Синхронизация файлов между репо |

**Telegram (опционально):** Создай `~/.config/aist/env` с:
```bash
export TELEGRAM_BOT_TOKEN="your-token"
export TELEGRAM_CHAT_ID="your-id"
```

**Установка:** `bash roles/synchronizer/install.sh`

> **Важно:** Синхронизатор заменяет отдельные launchd-агенты Стратега единым scheduler. После установки все роли запускаются из одной точки (com.exocortex.scheduler).

---

## Как добавить роль

Роли — точка расширения шаблона. Для добавления новой роли:

1. Создай директорию `roles/<name>/`
2. Добавь `README.md` с описанием
3. Если роль — ИИ-агент: добавь `prompts/` со сценариями
4. Если нужна автоматизация: добавь `scripts/` + `install.sh`
5. Зарегистрируй в `synchronizer/scripts/scheduler.sh` (если нужно расписание)
6. Добавь шаблон уведомления в `synchronizer/scripts/templates/<name>.sh`

---

## Порядок установки

```
1. Стратег (базовый, ставится через setup.sh)
   └── Работает автономно, достаточен для старта

2. Экстрактор (после 1-2 недель работы)
   └── Требует: хотя бы один Pack-репо + настроенный routing.md

3. Синхронизатор (когда нужна оркестрация)
   └── Заменяет отдельные launchd-агенты единым dispatcher
   └── Опционально: Telegram-уведомления
```

> Начни со Стратега. Экстрактор и Синхронизатор добавь, когда освоишь базовый цикл.
